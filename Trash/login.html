<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="login.css">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <script src="js/main.js"></script>
    <script>
        // Function to check if a user is authenticated
        function isAuthenticated() {
            return localStorage.getItem('loggedIn') === 'true';
        }

        // Function to toggle the login button based on authentication status
        function toggleLoginButton() {
            var loginButton = document.getElementById("loginButton");
            if (isAuthenticated()) {
                loginButton.innerText = "Login";
                loginButton.onclick = logout;
            } else {
                loginButton.innerText = "Login";
                loginButton.onclick = redirectToDefaultPage;
            }
        }

        // Function to register a new user
        function registerUser() {
            var username = document.getElementById("regUser").value;
            var password = document.getElementById("regPass").value;

            if (username && password) {
                localStorage.setItem('user', JSON.stringify({ username: username, password: password }));
                alert("Registration successful. You can now log in.");
                document.getElementById('login-form').style.display = 'block';
                document.getElementById('register-form').style.display = 'none';
            } else {
                alert("Please enter both username and password.");
            }
        }

        function redirectToDefaultPage() {
            var username = document.getElementById("user").value;
            var password = document.getElementById("pass").value;

            var storedUser = JSON.parse(localStorage.getItem('user'));

            if (storedUser && username === storedUser.username && password === storedUser.password) {
                localStorage.setItem('loggedIn', 'true');
                window.location.href = "index.html";
            } else {
                alert("Invalid username or password.");
            }
        }

        function logout() {
            localStorage.setItem('loggedIn', 'false');
            window.location.href = "index.html";
        }

        function initLoginButton() {
            toggleLoginButton();
            document.getElementById("loginButton").style.display = "inline-block";
        }

        function showRegistrationForm() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'block';
        }

        window.addEventListener("load", initLoginButton);
    </script>
</head>
<body>
    <div class="wrap">
        <!-- Login Form -->
        <div id="login-form" class="login_box">
            <div class="login-header">
                <h3>Discover<span></span>Cabuyao</h3>
            </div>
            <div class="input_box">
                <input type="text" id="user" class="input-field" required>
                <label for="user" class="label">Username</label>
                <i class="bx bx-user icon"></i>
            </div>
            <div class="input_box">
                <input type="password" id="pass" class="input-field" required>
                <label for="pass" class="label">Password</label>
                <i class="bx bx-lock-alt icon"></i>
            </div>
            <div class="remember-forgot">
                <div class="remember-me">
                    <input type="checkbox" id="remember">
                    <label for="remember">Remember me</label>
                </div>
                <div class="forgot">
                    <a href="#"></a>
                </div>
            </div>
            <div class="input_box">
                <button type="button" id="loginButton" class="input-submit">Login</button>
            </div>
            <div class="register">
                <span class="spans">Don't have an account? <a href="#" onclick="showRegistrationForm()">Register</a></span>
            </div>
        </div>

        <!-- Registration Form -->
        <div id="register-form" class="login_box" style="display:none;">
            <div class="login-header">
                <h3>Discover<span></span>Cabuyao</h3>
            </div>
            <div class="input_box">
                <input type="text" id="regUser" class="input-field" required>
                <label for="regUser" class="label">Username</label>
                <i class="bx bx-user icon"></i>
            </div>
            <div class="input_box">
                <input type="password" id="regPass" class="input-field" required>
                <label for="regPass" class="label">Password</label>
                <i class="bx bx-lock-alt icon"></i>
            </div>
            <div class="input_box">
                <button type="button" id="registerButton" class="input-submit" onclick="registerUser()">Register</button>
            </div>
            <div class="register">
                <span class="spans">Already have an account? <a href="index.html" onclick="document.getElementById('login-form').style.display='block'; document.getElementById('register-form').style.display='none';">Login</a></span>
            </div>
        </div>
    </div>
</body>
</html>